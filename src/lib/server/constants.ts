export const PASSWORD_SALT_ALPHABET =
	'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
export const PASSWORD_SALT_LENGTH = 10;

// Recommended minimum parameters in the Lucia demo app, generated by `sv create`:
export const HASH_MEMORY_COST = 19456;
export const HASH_TIME_COST = 2;
export const HASH_OUTPUT_LENGTH = 32;
export const HASH_PARALLELISM = 1;

export const ZXCVBN_SCORE_TOO_GUESSABLE = 0;
export const ZXCVBN_SCORE_VERY_GUESSABLE = 1;
export const ZXCVBN_SCORE_SOMEWHAT_GUESSABLE = 2;
export const ZXCVBN_SCORE_SAFELY_UNGUESSABLE = 3;
export const ZXCVBN_SCORE_VERY_UNGUESSABLE = 4;

import {
	SESSION_DURATION_DAYS as SESSION_DURATION_DAYS_STR,
	RENEW_SESSION_DAYS as RENEW_SESSION_DAYS_STR,
	VERIFICATION_CODE_ALPHABET,
	VERIFICATION_CODE_DURATION_MINUTES as VERIFICATION_CODE_DURATION_MINUTES_STR
} from '$env/static/private';

const SESSION_DURATION_DAYS = parseInt(SESSION_DURATION_DAYS_STR);

if (isNaN(SESSION_DURATION_DAYS)) {
	throw new Error(`Invalid SESSION_DURATION_DAYS: ${SESSION_DURATION_DAYS}`);
}

const RENEW_SESSION_DAYS = parseInt(RENEW_SESSION_DAYS_STR);

if (isNaN(RENEW_SESSION_DAYS)) {
	throw new Error(`Invalid RENEW_SESSION_DAYS: ${RENEW_SESSION_DAYS}`);
}

const VERIFICATION_CODE_DURATION_MINUTES = parseInt(VERIFICATION_CODE_DURATION_MINUTES_STR);

if (isNaN(VERIFICATION_CODE_DURATION_MINUTES)) {
	throw new Error(
		`Invalid VERIFICATION_CODE_DURATION_MINUTES: ${VERIFICATION_CODE_DURATION_MINUTES}`
	);
}

export {
	SESSION_DURATION_DAYS,
	RENEW_SESSION_DAYS,
	VERIFICATION_CODE_ALPHABET,
	VERIFICATION_CODE_DURATION_MINUTES
};
